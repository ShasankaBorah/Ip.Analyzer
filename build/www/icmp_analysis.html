<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ICMP Analysis</title>
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="js/jquery-2.1.4.js"></script>
    <script type="text/javascript" src="libs/materialize/js/materialize.js"></script>
    <script type="text/javascript" src="js/moment.js"></script>
    <link type="text/css" rel="stylesheet" href="libs/materialize/css/materialize.css" media="screen,projection" />
    <script type="text/javascript" src="chartist-js/chartist.js"></script>
    <link type="text/css" rel="stylesheet" href="chartist-js/chartist.min.css">
    <link type="text/css" rel="stylesheet" href="css/index.css">
    <link type="text/css" rel="stylesheet" href="css/palette.css">
    <link type="text/css " rel="stylesheet" href="libs/animate.css">
    <script type="text/javascript" src="libs/moment.js"></script>
    <script type="text/javascript" src="js/data-formatter.js"></script>
    <script type="text/javascript">
        // Declare global variables here
        var ws_command;
        var ws_messages;
        var g_data;
        var g_data_pair_only = []; //array to filled with pairs data only
        var g_database_obj;
        var two_way_only = false;
        var two_way_table_data; // =fill the variable with the data
        var max_size;
        var start;
        let next;
        let prev;
        var rows_per_page = 100;
        var limit = rows_per_page;
        var table_data;
        var from_database = false;
        var ten_subnet = /^10\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))$/;
        var one_nine_teo_subnet = /^192\.168\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))$/;
        var one_seven_2_subnet = /^172\.(1[6-9]|2[0-9]|3[0-1])\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))$/;
        var reserved_ip = /^100\.(6[4-9]|[7-9][0-9]|1([0-1][0-9]|2[0-7]))\.(0\.(0[ -9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))|([1-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5]))\.([0-9]|[1-9][0-9]|1([0-9][0-9])|2([0-4][0-9]|5[0-5])))$/;
        var excludePrivateIp = false;

        //var check = false;

        var table_result;

        $(document).ready(function () {
            initialise();
        });

        function initialise() {
            var host = window.location.host;
            ws_command = new WebSocket("ws://" + host + "/ws/command");

            onLoad_data_refresh();



            ws_command.onmessage = function (evt) {
                parse_command_reply(evt.data);
            }

            ws_message = new WebSocket("ws://" + host + "/ws/progress_message");
            ws_message.onmessage = function (evt) {
                parse_message(evt.data);
            }

            ws_message = new WebSocket("ws://" + host + "/ws/message");
            ws_message.onmessage = function (evt) {
                Materialize.toast(evt.data, 1000);
            }
            table_result = $('#table_result_icmp tbody');

            $(table_result).delegate("tr", "click", function (e) {
                display_seq_data($(e.currentTarget).children(":nth-child(1)").html());
                $('#table_result_icmp tr').removeClass('green lighten-2');
                $(e.currentTarget).addClass('green lighten-2');
            });

            $('#top_nav').load("top_nav.html", function () {
                $('#nav_icmp').addClass('red lighten-2');
            });
        }


        function parse_command_reply(data) {
            var obj = JSON.parse(data);
            if (obj.type == "icmp_result") {
                console.log("Analysis data received.");
                display_analysis_data(obj);
                $('#btn_start_icmp_analysis').removeClass('disabled');
            } else if (obj.type == "load_from_db") {
                console.log("icmp data from database received.");
                from_database = true;
                two_way_only = false;
                display_analysis_data(JSON.parse(obj.data));
                $('#btn_load_selected_dbs').removeClass('disabled');
            } else if (obj.type == "icmp_database") {
                console.log("Full icmp database files received.");
                display_icmp_database(obj);
                $('#btn_get_icmp_database_all').removeClass('disabled');
            }
        }

        function onLoad_data_refresh() {
            ws_command.onopen = function (evt) {
                ws_command.send("get_icmp_database_all");
            }
        }

        function parse_message(data) {
            var obj = JSON.parse(data);

            if (obj.type == "progress") {
                $('#p_current_file').html(obj.filename);
                $('#p_progress').html(numeral(obj.bytesRead).formatNumber() + '\\' + numeral(obj.fileSize).formatNumber() + ' (' + numeral(obj.bytesRead / obj.fileSize * 100).formatNumber(2) + '%)' + '(' + numeral(obj.seconds).formatNumber() + 'sec)');
                if (obj.total_time != undefined) {
                    $("#total_time_elapsed").html('Total Time Elapsed: ' + numeral(obj.total_time).formatNumber() + 'sec');
                }
            }

            if (obj.type == "api_progress") {
                $('#api_p_progress').html(numeral(obj.totalSetRead).formatNumber() + '\\' + numeral(obj.fileSize).formatNumber());
            }
        }

        function start_icmp_analysis() {

            if ($('#exclude_private_ip').get(0).checked) {
                excludePrivateIp = true;
            }
            $('#btn_start_icmp_analysis').addClass('disabled');
            $('#table_result_icmp tbody').empty();
            ws_command.send("start_icmp_analysis&" + excludePrivateIp);
        }

        function display_analysis_data(obj) { //for icmp analysis
            g_data = obj;
            two_way_table_data = obj.streams;

            var j = 0;
            for (i = 0; i < two_way_table_data.length; i++) {
                if ((two_way_table_data[i].folders_FL instanceof Array) && (two_way_table_data[i].folders_RL instanceof Array)) {
                    g_data_pair_only[j] = two_way_table_data[i];
                    j++;
                }
            }

            stream_data_file_result_body(obj);
            initialise_stream_display();
        }


        function stream_data_file_result_body(obj) {
            $('#file_result tbody').empty();

            if (obj.analysis_info) {
                var d_num = obj.analysis_info[0].Total_files_read;
                document.getElementById("d_num_files").innerHTML = d_num;

                var dtr = '<tr>';
                dtr += '<td>'
                dtr += obj.analysis_info[0].filePathFL;
                dtr += '</td>'

                dtr += '<td>'
                dtr += obj.analysis_info[0].filePathRL;
                dtr += '</td>'

                dtr += '<td>'
                dtr += obj.analysis_info[0].CreatedAt;
                dtr += '</td>'


                if (obj.analysis_info[0].FL_Files != undefined) {
                    dtr += '<td>'
                    for (j = 0; j < obj.analysis_info[0].FL_Files.length; j++) {
                        dtr += obj.analysis_info[0].FL_Files[j].pcapFileFl + ' (' + obj.analysis_info[0].FL_Files[j].size + ')' + '<br>';
                    }
                    dtr += '</td>'
                } else {
                    dtr += '<td>'
                    dtr += "No_files";
                    dtr += '</td>'
                }

                if (obj.analysis_info[0].RL_Files != undefined) {
                    dtr += '<td>'
                    for (j = 0; j < obj.analysis_info[0].RL_Files.length; j++) {
                        dtr += obj.analysis_info[0].RL_Files[j].pcapFileRl + ' (' + obj.analysis_info[0].RL_Files[j].size + ')' + '<br>';
                    }
                    dtr += '</td>'
                } else {
                    dtr += '<td>'
                    dtr += "No_files";
                    dtr += '</td>'
                }

                dtr += '</tr>';
                $('#file_result tbody').append(dtr);
            }
        }




        function initialise_stream_display() {
            if (g_data == undefined) return;

            if (from_database == true) {
                limit = rows_per_page;
            }

            table_data = g_data.streams;
            max_size = table_data.length;
            start = 0;

            limit = Math.min(table_data.length, limit);

            //display_req_rep_pairs_only();

            display_stream_data(start, limit);
            $('#p_table_result_info').html(1 + '-' + limit + '(' + max_size + ')');
        }

        function display_stream_data(start, limit) {
            table_result.empty();

            if (table_data == undefined || !(table_data instanceof Array)) return;

            for (i = start; i < limit; ++i) {
                var stream = table_data[i];
                var str = '<tr>';
                str += '<td>' + (i + 1) + '</td>';
                str += '<td>' + stream.SrcIp + '</td>';

                if (ipCompare_to_private(stream.SrcIp)) {
                    str += '<td>' + "privateIP" + '</td>';
                }
                else if (stream.src_info == "NA") {
                    str += '<td>' + "NA" + '</td>';
                }
                else {
                    str += '<td>' + stream.src_info.countryName + '</td>';
                }

                str += '<td>' + stream.DstIp + '</td>';

                if (ipCompare_to_private(stream.DstIp)) {
                    str += '<td>' + "privateIP" + '</td>';
                }
                else if (stream.dst_info == "NA") {
                    str += '<td>' + "NA" + '</td>';
                }
                else {
                    str += '<td>' + stream.dst_info.countryName + '</td>';
                }

                str += '<td>' + stream.src_dst + '</td>';
                str += '<td>' + stream.dst_src + '</td>';
                str += '<td>';
                if (stream.folders_FL instanceof Array) {
                    for (j = 0; j < stream.folders_FL.length; ++j) {
                        str += stream.folders_FL[j] + "<br>";
                    }
                }
                str += '</td>';
                str += '<td>';
                if (stream.folders_RL instanceof Array) {
                    for (j = 0; j < stream.folders_RL.length; ++j) {
                        str += stream.folders_RL[j] + "<br>";
                    }
                }
                str += '</td>';

                str += '<td>';
                let count = 0;
                for (let k = 0; k < stream.sequence_array.length; ++k) {
                    totalCount = stream.sequence_array.length;
                    if (stream.sequence_array[k].request == true && stream.sequence_array[k].reply == true) {
                        count += 1;
                    }

                }
                str += count + '</td>';

                str += '</tr>';
                table_result.append(str);
            }
        }

        function ipCompare_to_private(ip) //to compare src or dst string to check if its private or public
        {
            //true == private ; false == public
            if (ten_subnet.test(ip)) {
                return true;
            }
            else if (one_nine_teo_subnet.test(ip)) {
                return true;
            }
            else if (one_seven_2_subnet.test(ip)) {
                return true;
            }
            else if (reserved_ip.test(ip)) {
                return true;
            }
            else
                return false;

        }

        function funct_to_load_two_way_pairs(start, limit) // function to display pairs only after #function called by load_two_way_icmp function
        {
            table_result.empty();


            if (g_data_pair_only == undefined || !(g_data_pair_only instanceof Array)) return;

            for (i = start; i < limit; i++) {
                var stream = g_data_pair_only[i];
                var pair_str = '<tr>';
                pair_str += '<td>' + (i + 1) + '</td>';
                pair_str += '<td>' + stream.SrcIp + '</td>';
                //for src ip 
                if (ipCompare_to_private(stream.SrcIp)) {
                    pair_str += '<td>' + "privateIP" + '</td>';
                }
                else if (stream.src_info == "NA") {
                    pair_str += '<td>' + "NA" + '</td>';
                }
                else {
                    pair_str += '<td>' + stream.src_info.countryName + '</td>';
                }

                pair_str += '<td>' + stream.DstIp + '</td>';

                if (ipCompare_to_private(stream.DstIp)) {
                    pair_str += '<td>' + "privateIP" + '</td>';
                }
                else if (stream.dst_info == "NA") {
                    pair_str += '<td>' + "NA" + '</td>';
                }
                else {
                    pair_str += '<td>' + stream.dst_info.countryName + '</td>';
                }
                pair_str += '<td>' + stream.src_dst + '</td>';
                pair_str += '<td>' + stream.dst_src + '</td>';
                pair_str += '<td>';
                if (stream.folders_FL instanceof Array) {
                    for (j = 0; j < stream.folders_FL.length; j++) {
                        pair_str += stream.folders_FL[j] + "<br>";
                    }
                }
                pair_str += '</td>';
                pair_str += '<td>';
                if (stream.folders_RL instanceof Array) {
                    for (j = 0; j < stream.folders_RL.length; ++j) {
                        pair_str += stream.folders_RL[j] + "<br>";
                    }
                }
                pair_str += '</td>';


                pair_str += '<td>';
                let count = 0;
                for (let k = 0; k < stream.sequence_array.length; ++k) {
                    totalCount = stream.sequence_array.length;
                    if (stream.sequence_array[k].request == true && stream.sequence_array[k].reply == true) {
                        count += 1;
                    }

                }
                pair_str += count + '</td>';

                // pair_str += '<td>';
                // if(streams.)

                pair_str += '</tr>';
                table_result.append(pair_str);
            }
        }



        function load_two_way_icmp() { //to load two way data
            $('#btn_load_two_way_icmp').addClass('disabled');
            $('#btn_reset').removeClass('disabled');
            max_size = g_data_pair_only.length;
            start = 0;
            limit = Math.min(g_data_pair_only.length, limit);
            two_way_only = true;
            funct_to_load_two_way_pairs(start, limit);
            $('#p_table_result_info').html(1 + '-' + limit + '(' + max_size + ')');
        }


        function load_all_icmp_streams() { // to reset the table to original data
            $('#btn_load_two_way_icmp').removeClass('disabled');
            $('#btn_reset').addClass('disabled');
            limit = rows_per_page;
            two_way_only = false;
            initialise_stream_display();
            // $('#btn_reset').removeClass('disabled');
        }

        function load_table_result_next() {
            $('#btn_reset').removeClass('disabled');
            if (two_way_only == true) {
                var next_pairs = limit;
            } else {
                if (limit != max_size) {
                    next = limit;
                }

            }
            if (two_way_only == true) {
                if (max_size > next_pairs) {
                    limit = limit + rows_per_page;
                    limit = Math.min(g_data_pair_only.length, limit);
                    table_result.empty();
                    funct_to_load_two_way_pairs(next_pairs, limit);
                    $('#p_table_result_info').html((next_pairs + 1) + '-' + limit + '(' + max_size + ')');
                }
            } else if (max_size > next) {
                limit = limit + rows_per_page;
                limit = Math.min(table_data.length, limit);
                table_result.empty();
                display_stream_data(next, limit);
                $('#p_table_result_info').html((next + 1) + '-' + limit + '(' + max_size + ')');
            }
        }

        function load_table_result_prev() {
            if (two_way_only == true) {
                if ((limit % 100) == 0) {
                    var prev_two_way = limit - (2 * rows_per_page);
                    if (prev_two_way >= 0) {
                        limit = limit - rows_per_page;
                    } else {
                        prev_two_way = 0;
                        limit = Math.min(rows_per_page, limit);
                    }
                    table_result.empty();
                    funct_to_load_two_way_pairs(prev_two_way, limit);
                    $('#p_table_result_info').html((prev_two_way + 1) + '-' + limit + '(' + max_size + ')');

                } else {
                    var k = limit - rows_per_page;
                    if (k > 0) {
                        var prev_two_way = limit - k;
                        if (prev_two_way >= 0) {
                            var v = limit - (2 * rows_per_page);
                            limit = limit - v;
                        } else {
                            prev_two_way = 0;
                            limit = Math.min(rows_per_page, limit);
                        }
                        table_result.empty();
                        funct_to_load_two_way_pairs(prev_two_way, limit);
                        $('#p_table_result_info').html((prev_two_way + 1) + '-' + limit + '(' + max_size + ')');
                    }

                }
            } else {
                if (limit != max_size) {
                    if (limit % 100 == 0) {
                        prev = limit - 2 * rows_per_page;
                        if (prev >= 0) {
                            limit = limit - rows_per_page;
                        } else {
                            prev = 0;
                            limit = rows_per_page;
                        }
                    }
                }

                else {
                    let diff = (limit - next);
                    limit = limit - diff;
                    prev = limit - rows_per_page;
                }
                table_result.empty();
                display_stream_data(prev, limit);
                $('#p_table_result_info').html((prev + 1) + '-' + limit + '(' + max_size + ')');
            }
        }


        // function display_req_rep_pairs_only() {
        //     $('#table_sequence2 tbody').empty();
        //     var count = 0;
        //     for (i = 0; i < table_data.length; i++) {
        //         var req_rep_pairs_only = table_data[i];

        //         for (p = 0; p < req_rep_pairs_only.sequence_array.length; p++) {
        //             if ((req_rep_pairs_only.sequence_array[p].reply == true) && (req_rep_pairs_only.sequence_array[p].request == true)) {
        //                 //  check = true;
        //                 var rrpair_str = '<tr>';
        //                 rrpair_str += '<td>' + (count + 1) + '</td>';
        //                 rrpair_str += '<td>' + req_rep_pairs_only.sequence_array[p].sequence_no + '</td>';
        //                 rrpair_str += '<td>' + req_rep_pairs_only.sequence_array[p].request + '</td>';
        //                 rrpair_str += '<td>' + req_rep_pairs_only.sequence_array[p].reply + '</td>';
        //                 rrpair_str += '<td>' + req_rep_pairs_only.sequence_array[p].unsupported_type + '</td>';
        //                 rrpair_str += '</tr>';
        //                 count++;
        //                 $('#table_sequence2 tbody').append(rrpair_str);

        //             }
        //         }
        //     }
        // }


        // to show the data after a row nhas been clicked
        function display_seq_data(idx) {
            if (two_way_only == true) {
                if (idx > 0 && idx <= g_data_pair_only.length) {
                    var stream = g_data_pair_only[idx - 1];
                }
            } else {
                if (idx > 0 && idx <= table_data.length) {
                    var stream = table_data[idx - 1];
                }
            }
            //            if (idx > 0 && idx <= table_data.length) {
            //                var stream = table_data[idx - 1];

            $('#table_sequence tbody').empty();

            $('#p_seq_src').html(stream.SrcIp);
            $('#p_seq_dst').html(stream.DstIp);

            // to show total number of transaction
            let totalTransactions = stream.sequence_array.length;
            $('#total_transactions').html(totalTransactions);

            // to show the total number of pairs with req and rep == true
            let count = 0;
            let unreachableCount = 0;
            let timeExceededCount = 0;
            let roundTsArray = [];
            for (let i = 0; i < totalTransactions; i++) {
                let req = stream.sequence_array[i].request;
                let rep = stream.sequence_array[i].reply;


                if (req == true && rep == true) {
                    let repTime = stream.sequence_array[i].repts;
                    let reqTime = stream.sequence_array[i].reqts;

                    let diffInTime = repTime - reqTime;

                    roundTsArray.push(diffInTime);
                    count++;
                }
                else if (stream.sequence_array[i].dstUnreachable != false) {
                    unreachableCount++;
                }
                else if (stream.sequence_array[i].dstUnreachable != false) {
                    timeExceededCount++;

                }
            }

            $('#total_pairs').html(count);
            $('#total_unreachable').html(unreachableCount);
            $('#total_timeexceeded').html(timeExceededCount);

            // let min = Math.min(...roundTsArray);
            // let max = Math.max(...roundTsArray);

            var total = 0;
            var minTime = Number.MAX_VALUE;
            var maxTime = 0;
            var avg;
            if (roundTsArray.length > 0) {

                for (let i = 0; i < roundTsArray.length; i++) {
                    minTime = (roundTsArray[i] < minTime) ? roundTsArray[i] : minTime;
                    maxTime = (roundTsArray[i] > maxTime) ? roundTsArray[i] : maxTime;
                    total += roundTsArray[i];
                }
                avg = moment.duration(total / roundTsArray.length);
            }
            else {
                minTime = "NA";
                maxTime = "NA";
                avg = "NA"

            }




            //const arrAvg =  roundTsArray.reduce((a,b) => a + b, 0) / roundTsArray.length

            $('#min_round_time').html(minTime);
            $('#max_round_time').html(maxTime);
            if (avg == 'NA') {
                $('#average_round_time').html(avg);
            }
            else {
                $('#average_round_time').html((avg.hours() > 0 ? avg.hours() + ' hrs ' : '') + (avg.minutes() > 0 ? avg.minutes() + ' mins ' : '') + (avg.seconds() > 0 ? avg.seconds() + ' seconds ' : '') + parseInt(avg.milliseconds()) + ' msecs');
            }


            var str = "";
            for (k = 0; k < stream.sequence_array.length; k++) {
                var req = stream.sequence_array[k].request;
                var rep = stream.sequence_array[k].reply;
                if (req == true && rep == true) {
                    let repTime = stream.sequence_array[k].repts;
                    let reqTime = stream.sequence_array[k].reqts;

                    let diffInTime = moment.duration(repTime - reqTime);

                    str += '<tr class="green">';
                    str += '<td>' + (k + 1) + '</td>';
                    str += '<td>' + stream.sequence_array[k].sequence_no + '</td>';
                    str += '<td>' + stream.sequence_array[k].reqts + '</td>';
                    str += '<td>' + stream.sequence_array[k].repts + '</td>';
                    str += '<td>' + (diffInTime.hours() > 0 ? diffInTime.hours() + ' hrs ' : '') + (diffInTime.minutes() > 0 ? diffInTime.minutes() + ' mins ' : '') + (diffInTime.seconds() > 0 ? diffInTime.seconds() + ' seconds ' : '') + (diffInTime.milliseconds() + ' msecs') + '</td>';
                }
                else {
                    str += '<tr>';
                    str += '<td>' + (k + 1) + '</td>';
                    str += '<td>' + stream.sequence_array[k].sequence_no + '</td>';

                    if (req == true) {
                        str += '<td>' + stream.sequence_array[k].reqts + '</td>';
                    }
                    else {
                        str += '<td>' + "NA" + '</td>';
                    }

                    if (rep == true) {
                        str += '<td>' + stream.sequence_array[k].repts + '</td>';
                    }
                    else {
                        str += '<td>' + "NA" + '</td>';
                    }

                    str += '<td>' + "NA" + '</td>';
                }
                str += '</tr>';
            }
            $('#table_sequence tbody').append(str);
        }

        function get_icmp_database_all() {
            $('#btn_get_icmp_database_all').addClass('disabled');
            ws_command.send("get_icmp_database_all");
        }


        function display_icmp_database(obj) //for displaying the database file in the select section
        {
            if (obj.data == undefined) return;

            $.each(obj.data, function (i, item) {
                $('#select_db_list').append($('<option>', {
                    value: item,
                    text: item
                }));
            });

            $('#select_db_list').material_select();
        }

        function load_selected_db() {
            $('#btn_load_selected_dbs').addClass('disabled');
            //btn_load_selected_dbs
            let selected_db = $('#select_db_list :selected').val();
            ws_command.send("load_selected_icmp_db&" + selected_db.toString());
        }



        //code to search IP address from the table
        function searchipFunction() {
            // Declare variables
            var input, filter, table, tr, td, i;
            input = document.getElementById("myInput");
            filter = input.value.toUpperCase();
            table = document.getElementById("table_result_icmp");
            tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[1];
                if (td) {
                    if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }


    </script>
</head>

<body>
    <div id="top_nav"></div>

    <div class="row">
        <br>
        <br>

        <!-- div to show the tabs-->
        <!--        <div id="div_icmp_analysis">icmp analysis</div>-->
        <div class="row" id="div_icmp_analysis">
            <div class="row">
                <div class="col s12">
                    <div class="row">
                        <button class="btn col s1" id="btn_start_icmp_analysis" onclick="start_icmp_analysis()">ICMP Analysis</button>
                        <!-- <button class="btn" id="btn_load_from_icmp_db" onclick="load_from_icmp_db()">Load from database</button> -->
                        <button class="btn col s1" id="btn_load_two_way_icmp" onclick="load_two_way_icmp()">Load Two Way</button>
                        <button class="btn col s1" id="btn_reset" onclick="load_all_icmp_streams()">Reset</button>
                        <!-- <button onclick="get_icmp_database_all()" data-target="modal1" class="btn modal-trigger">Database</button> -->

                        <div class="input-field col s3">
                            <select id="select_db_list"></select>
                            <label>Available Databases</label>
                        </div>
                        <button class="btn col s1" id="btn_load_selected_dbs" onclick="load_selected_db()">Load Selected File</button>
                        <h6 class="col s1">Number of Files Read :
                            <span id="d_num_files"></span>
                        </h6>

                        <div class="col s2">
                            <form>
                                <p>
                                    <input class="with-gap" checked="checked" name="ex_Private_ip" type="checkbox" id="exclude_private_ip" />
                                    <label for="exclude_private_ip">Exclude Private Ip</label>
                                </p>
                            </form>
                        </div>
                    </div>

                </div>
            </div>


            <div class="row">
                <P id="p_current_file"></P>
                <p id="p_progress"></p>
            </div>

            <div>
                <p id="total_time_elapsed"></p>
            </div>


            <!-- api call progress-->
            <div class="row">
                <!--<P id="api_p_current_file"></P>-->
                <p id="api_p_progress"></p>
            </div>

            <!--File Info display table-->
            <div class="row">
                <div class="col s12">
                    <!--file div-->
                    <table id="file_result">
                        <thead>
                            <tr>
                                <th>FL File Path</th>
                                <th>RL File Path</th>
                                <th>Created At</th>
                                <th>FL Files Read</th>
                                <th>RL FIles Read</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <!-- <div class="col s6">
                <table id="pairs_result">
                    <thead>
                        <tr>
                            <th>FL Frequencies</th>
                            <th>RL Frequencies</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div> -->


            <!--data display table-->
            <div class="row">
                <button class="btn" id="btn_table_result_prev" onclick="load_table_result_prev()">Prev</button>
                <button class="btn" id="btn_table_result_next" onclick="load_table_result_next()">Next</button>
                <p id="p_table_result_info"></p>
            </div>


            <div class="row">
                <div class="col s7">
                    <input type="text" id="myInput" onkeyup="searchipFunction()" placeholder="Search Source for IP..">
                </div>
            </div>


            <div class="row">
                <div class="col s7" style="overflow-y: scroll; height:800px;">
                    <table id="table_result_icmp" class="bordered highlight">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Source IP</th>
                                <th>Src Country</th>
                                <th>Destination IP</th>
                                <th>Dest Country</th>
                                <th>Source To Dest.</th>
                                <th>Dest. To Source</th>
                                <th>FL Frequencies</th>
                                <th>RL Frequencies</th>
                                <th>Total Pairs</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div id="result"> </div>
                <div class="col s5">
                    <div class="row">
                        <div class="col s6">
                            <div>Source IP Address:
                                <span id="p_seq_src" />
                            </div>
                        </div>
                        <div class="col s6">
                            <div>Destination IP Address:
                                <span id="p_seq_dst" />
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- div for total transactions -->
                        <div class="col s6"> Total Transactions:
                            <span id="total_transactions"></span>
                        </div>

                        <!-- div to show the pairs in the clicked ip  -->
                        <div class="col s6"> Total Pairs:
                            <span id="total_pairs"></span>
                        </div>
                    </div>

                    <!-- to show unreachable count and time exceeded count -->
                    <div class="row">
                        <div class="col s6">
                            Total Unreachable :
                            <span id="total_unreachable"></span>
                        </div>
                        <div class="col s6">
                            Total TimeExceeded :
                            <span id="total_timeexceeded"></span>
                        </div>
                    </div>

                    <!-- to show min round time , max round tiem and average of round time -->
                    <div class="row">
                        <div class="col s4">
                            Min. Round Time :
                            <span id="min_round_time"></span>
                        </div>
                        <div class="col s4">
                            Max. Round Time :
                            <span id="max_round_time"></span>
                        </div>
                        <div class="col s4">
                            Average Round Time :
                            <span id="average_round_time"></span>
                        </div>

                    </div>



                    <div class="row" style="overflow-y: scroll; height:800px;">
                        <div class="col s12">
                            <table id="table_sequence" class="bordered highlight">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Sequence Number</th>
                                        <th>Request(Msec)</th>
                                        <th>Reply(Msec)</th>
                                        <th>Round Time(Msec)</th>
                                        <!-- <th>TTL Expire</th>
                                        <th>Unreachable</th> -->
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- <div class="row">
                        <div class="col s6">
                            <div>Total Icmp Pairs From all Files: </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col s12">
                            <table id="table_sequence2" class="bordered highlight">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Sequence Number</th>
                                        <th>Request</th>
                                        <th>Reply</th>
                                        <th>Unsupported Type</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div> -->
                </div>
            </div>
        </div>
    </div>
    <!-- display icmp database and perform action -->
    <!-- <div class="row" id="database_icmp">
            <div class="col s6">
                <div class="row">
                    <div class="col s4">
                        <button class="btn" id="btn_get_icmp_database_all" onclick="get_icmp_database_all()">Show Database Files</button>
                    </div>
                </div>

                <table id="icmp_table_database_files" class="highlight">
                    <thead>
                        <tr>
                            <th>Filename</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

        </div> -->
    <!-- </div> -->

</body>

</html>